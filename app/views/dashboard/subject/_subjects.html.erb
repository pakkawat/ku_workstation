<% was_updated = subject.ku_users.where("user_subjects.state != 'none'").count + subject.programs.where("programs_subjects.state != 'none'").count %>
<tr>
	<td scope="row"><%= subject.subject_id %></td>
	<td><%= link_to subject.subject_name, subject %></td>
	<td>

    <div style="display:inline-block;">
      <%= button_to [:apply_change, subject], :class => "btn btn-primary", :method => :get, :disabled => was_updated == 0 ? true : false, data: {title: "Apply change", confirm: 'It will take a long time to process, Are you sure?'} do %>
        Apply change
        <% if was_updated != 0 %>
          <%= content_tag :span, was_updated, class: 'badge' %>
        <% end %>
      <% end %>
    </div>

		<div style="display:inline-block;">
			<%= button_to 'Programs', subject_programs_subjects_path(subject), :class => "btn btn-info", :method => :get %>
		</div>
		<div style="display:inline-block;">
      <%= button_to 'Users', subject_user_subjects_path(subject), :class => "btn btn-warning", :method => :get %>
		</div>
	</td>
</tr>
